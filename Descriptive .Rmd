---
title: "STAT 602_FINAL_GROUP 11"
author: "GROUP 11"
header-includes:
output:
  pdf_document: 
    latex_engine: xelatex
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(message=F,warning=F,echo=F,cache = F)
knitr::opts_chunk$set(out.extra = "")

```

**DATA EXPLORATION**

For this project, we used two dataset namely the labeled and the unlabeled data.The labeled data(training dataset) has 3000 observations and 8 variables.The unlabeled dataset is drawn from three samples namely samples A,B,C.The observations for sample A, B and C are 777,1373 and 982 respectively. Roundness which is the measure of how closely the shape of beans approaches a perfect circle was calculated following and added as an additional predictor variable(Koklu & Ozkan, 2020).Table 1 shows the summary statistics of the variables in the labeled data.The variables, Area and Convex Area, had the largest range of 230675.000 and 230675.000, respectively. There are large differences in the range of variables, those variables with larger ranges will dominate over those with small ranges which may lead to biased results, therefore it is necessary for the variables to be transformed/scaled to be used in fitting our models. The dependent variable (Class) had 6 levels(Table 2).Table 2 shows that Bombay has the highest grams and price per seed.The price per seed is the product of the price per pound and price per seed divided by the total weight of 453.592.

The histograms(Figure 1) show evidence of multimodality behavior in the variables. This means that at least one of the classes of beans is very distinct from the others. This is corroborated by the boxplots (Fig 2), which shows that the BOMBAY beans are very distinct from the other beans. It can be seen that roundness seems to be the a strong predictor for the SEKER class since it has slightly highest median and IQs. Extent and Eccentricity seems to be good predictors for HOROZ and SEKER. The violin plots for each classes (fig 2) shows that most of the class distributions are approximately normal except for the distributions for roundness and extent. From this distributions, we expect BOMBAY to be easily predicted by our models for the labeled datset. We expect to see very low predictions of BOMBAY for all the three sample datasets. The variance of each variable by class also show evidence of non-coonstant variance. Based on the normality distribution and non-constant variance, we expect models such as QDA to perform well. The principal component analysis indicates that 3 components which are new variables that are constructed as linear combinations or mixtures of the initial variables are best in explaining the data.


We also explored how the variables are correlated using the corrplot function in R. The correlation plot shows that most of the variables are highly correlated(Figure 3). We explored for outliers for each of the predictors for all the 6 Class levels of beans. We found innumerable outliers but did not delete them because since transformation or scaling of the variables will reduce the impact of these outliers. 


\newpage


```{r, include=FALSE}
## Library
library(ggplot2)
library(corrplot)
library(kableExtra)
library(gridExtra)
library(psych)
library(dplyr)

theme_set(theme_light())
```


```{r}
labeled <- read.csv('labeled.csv') %>% dplyr::select(-X)%>%mutate(Class=as.factor(Class))
sampA <- read.csv('samp.A.csv')%>% dplyr::select(-X)
sampB <- read.csv('samp.B.csv')%>% dplyr::select(-X)
sampC <- read.csv('samp.C.csv')%>% dplyr::select(-X)

#set up a new variable 'Roundness'
#Roundness = 4*Area*pi/(perimeter)^2 (refer to the dry bean paper)
labeled$Roundness <- 4*pi*labeled$Area/(labeled$Perimeter)^2
sampA$Roundness <- 4*pi*sampA$Area/(sampA$Perimeter)^2
sampB$Roundness <- 4*pi*sampB$Area/(sampB$Perimeter)^2
sampC$Roundness <- 4*pi*sampC$Area/(sampC$Perimeter)^2

##check for duplicate rows
#dup.rows = sum(labeled%>%duplicated(), sampA%>%duplicated(), sampB%>%duplicated(),sampC%>%duplicated())
#
##Statistics summary
#kable(summary(labeled), caption = 'Statistic summary table of labeled dataset')
#kable(summary(sampA), caption = 'Statistic summary table of sampleA dataset')
#kable(summary(sampB), caption = 'Statistic summary table of sampleB dataset')
#kable(summary(sampC), caption = 'Statistic summary table of sampleC dataset')
```


```{r, }

summary.stats <- round(as.data.frame((labeled[,-8])%>%psych::describe())%>%dplyr::select(n,mean, sd, median, min, max, range, se), 3)

library(kableExtra)
kable(summary.stats, caption="Statistical distribution of features of dry beans varieties(in pixels)", format="pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```


```{r}
summary.stats.A <- round(as.data.frame((sampA)%>%psych::describe())%>%dplyr::select(n,mean, sd, median, min, max, range), 3)
kable(summary.stats.A, caption="Statistical distribution of features of dry beans varieties(in pixels) - Sample A", format="pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```
```{r}
summary.stats.B <- round(as.data.frame((sampB)%>%psych::describe())%>%dplyr::select(n,mean, sd, median, min, max, range), 3)
kable(summary.stats.B, caption="Statistical distribution of features of dry beans varieties(in pixels) - Sample B", format="pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```
```{r}
summary.stats.C <- round(as.data.frame((sampC)%>%psych::describe())%>%dplyr::select(n,mean, sd, median, min, max, range), 3)
kable(summary.stats.C, caption="Statistical distribution of features of dry beans varieties(in pixels) - Sample C", format="pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```

```{r}
var.tab1 <- labeled%>%group_by(Class)%>% summarize(Var.Area=sd(Area),
                                       Var.Perimeter=var(Perimeter), var.Maj.Axis.=var(MajorAxisLength), var.Min.Axis.=var(MinorAxisLength), var.Eccentricity=min(Eccentricity))

var.tab2 <- labeled%>%group_by(Class)%>% summarize(var.ConvexArea=max(ConvexArea), var.Extent=max(Extent), var.Roundness=max(Roundness))

kable(var.tab1, caption = "Variance of distribution", format = "pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```

```{r}
kable(var.tab2, caption = "Variance of distribution", format = "pandoc")%>%kable_styling(latex_option=c("hold_position"), full_width = F)%>%kable_classic(html_font = "Cambria")
```



```{r}

classes <- c("BOMBAY", "CALI", "DERMASON", "HOROZ", "SEKER", "SIRA")

price.per.1b <- c("$5.56", "$6.02", "$1.98", "$2.43", "$2.72", "$5.40")

price.per.pound <- c(5.56, 6.02, 1.98, 2.43, 2.72, 5.40)
names(price.per.pound) <- classes

grams.per.seed <- c(1.92, 0.61, 0.28, 0.52, 0.49, 0.38)
names(grams.per.seed) <- classes

grams.per.pound <- 453.592

price.per.seed <- round(((price.per.pound*grams.per.seed)/grams.per.pound),6)

price.weight.data <-  cbind(price.per.1b, grams.per.seed, price.per.seed)

kable(price.weight.data, col.names=c("price per pound", "grams per seed", "price per seed"), caption="distribution of types of dry beans and prices per seed",format = "pandoc")
```



```{r, fig.height=9, message=F, fig.cap="Histograms of Variables - Labeled Data"}
grid.arrange(
labeled%>%ggplot() + geom_histogram(aes(x=Area), fill="light blue", col="brown")+ labs(title = "Area"),
labeled%>%ggplot() + geom_histogram(aes(x=Perimeter), fill="light blue", col="brown")+ labs(title = "Perimeter"),
labeled%>%ggplot() + geom_histogram(aes(x=MajorAxisLength), fill="light blue", col="brown")+ labs(title = "MajorAxisLength"),
labeled%>%ggplot() + geom_histogram(aes(x=MinorAxisLength), fill="light blue", col="brown")+ labs(title = "MinorAxisLength"),
labeled%>%ggplot() + geom_histogram(aes(x=ConvexArea), fill="light blue", col="brown")+ labs(title = "ConvexArea"),
labeled%>%ggplot() + geom_histogram(aes(x=Roundness), fill="light blue", col="brown")+ labs(title = "Roundness"),
labeled%>%ggplot() + geom_histogram(aes(x=Extent), fill="light blue", col="brown")+ labs(title = "Extent"),ncol=2)
```

```{r, fig.height=9, message=F, fig.cap="Histograms of Variables - Sample A"}
grid.arrange(
sampA%>%ggplot() + geom_histogram(aes(x=Area), fill="light blue", col="brown")+ labs(title = "Area"),
sampA%>%ggplot() + geom_histogram(aes(x=Perimeter), fill="light blue", col="brown")+ labs(title = "Perimeter"),
sampA%>%ggplot() + geom_histogram(aes(x=MajorAxisLength), fill="light blue", col="brown")+ labs(title = "MajorAxisLength"),
sampA%>%ggplot() + geom_histogram(aes(x=MinorAxisLength), fill="light blue", col="brown")+ labs(title = "MinorAxisLength"),
sampA%>%ggplot() + geom_histogram(aes(x=ConvexArea), fill="light blue", col="brown")+ labs(title = "ConvexArea"),
sampA%>%ggplot() + geom_histogram(aes(x=Roundness), fill="light blue", col="brown")+ labs(title = "Roundness"),
sampA%>%ggplot() + geom_histogram(aes(x=Extent), fill="light blue", col="brown")+ labs(title = "Extent"),ncol=2)
```

```{r, fig.height=9, message=F, fig.cap="Histograms of Variables - Sample B"}
grid.arrange(
sampB%>%ggplot() + geom_histogram(aes(x=Area), fill="light blue", col="brown")+ labs(title = "Area"),
sampB%>%ggplot() + geom_histogram(aes(x=Perimeter), fill="light blue", col="brown")+ labs(title = "Perimeter"),
sampB%>%ggplot() + geom_histogram(aes(x=MajorAxisLength), fill="light blue", col="brown")+ labs(title = "MajorAxisLength"),
sampB%>%ggplot() + geom_histogram(aes(x=MinorAxisLength), fill="light blue", col="brown")+ labs(title = "MinorAxisLength"),
sampB%>%ggplot() + geom_histogram(aes(x=ConvexArea), fill="light blue", col="brown")+ labs(title = "ConvexArea"),
sampB%>%ggplot() + geom_histogram(aes(x=Roundness), fill="light blue", col="brown")+ labs(title = "Roundness"),
sampB%>%ggplot() + geom_histogram(aes(x=Extent), fill="light blue", col="brown")+ labs(title = "Extent"),ncol=2)
```

```{r, fig.height=9, message=F, fig.cap="Histograms of Variables - Sample C"}
grid.arrange(
sampC%>%ggplot() + geom_histogram(aes(x=Area), fill="light blue", col="brown")+ labs(title = "Area"),
sampC%>%ggplot() + geom_histogram(aes(x=Perimeter), fill="light blue", col="brown")+ labs(title = "Perimeter"),
sampC%>%ggplot() + geom_histogram(aes(x=MajorAxisLength), fill="light blue", col="brown")+ labs(title = "MajorAxisLength"),
sampC%>%ggplot() + geom_histogram(aes(x=MinorAxisLength), fill="light blue", col="brown")+ labs(title = "MinorAxisLength"),
sampC%>%ggplot() + geom_histogram(aes(x=ConvexArea), fill="light blue", col="brown")+ labs(title = "ConvexArea"),
sampC%>%ggplot() + geom_histogram(aes(x=Roundness), fill="light blue", col="brown")+ labs(title = "Roundness"),
sampC%>%ggplot() + geom_histogram(aes(x=Extent), fill="light blue", col="brown")+ labs(title = "Extent"),ncol=2)
```
  


```{r, fig.height=11, fig.width=9, fig.cap="Boxplots of Variables by Classes"}
library(gridExtra)
grid.arrange(
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=Area), col="brown")  + labs(title = "Boxplot of class vs Area") + geom_violin(aes(x=Class, y=Area), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=Perimeter), col="brown") + labs(title = "Boxplot of class vs Perimeter") + geom_violin(aes(x=Class, y=Perimeter), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=MajorAxisLength), col="brown") + labs(title = "Boxplot of class vs MajorAxisLength") + geom_violin(aes(x=Class, y=MajorAxisLength), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=MinorAxisLength), col="brown") + labs(title = "Boxplot of class vs MinorAxisLength") + geom_violin(aes(x=Class, y=MinorAxisLength), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=ConvexArea), col="brown") + labs(title = "Boxplot of class vs ConvexArea") + geom_violin(aes(x=Class, y=ConvexArea), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=Roundness), col="brown") + labs(title = "Boxplot of class vs Roundness") + geom_violin(aes(x=Class, y=Roundness), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=Extent), col="brown") + labs(title = "Boxplot of class vs Extent") + geom_violin(aes(x=Class, y=Extent), alpha=0.4),
labeled%>%group_by(Class)%>%ggplot() + geom_boxplot(aes(x=Class, y=Eccentricity), col="brown") + labs(title = "Boxplot of class vs Eccentricity") +geom_violin(aes(x=Class, y=Eccentricity), alpha=0.4),ncol=2)
```




```{r, fig.cap='Correlation plot of the labeled dataset'}
corrplot(cor(labeled%>% dplyr::select(-Class)), method = 'ellipse', type = "lower")
```





```{r, fig.cap='Correlation plot of the sample A dataset'}
corrplot(cor(sampA), method = 'ellipse', type = "lower")
```

```{r, fig.cap='Correlation plot of the sample B dataset'}
corrplot(cor(sampB), method = 'ellipse', type = "lower")
```


```{r, fig.cap='Correlation plot of the sample C dataset'}
corrplot(cor(sampC), method = 'ellipse', type = "lower")
```

```{r, fig.width=5, fig.height=4}
library(GGally)
#labeled%>%filter(Class=="BOMBAY")%>%ggcorr()


par(mfrow=c(2,3))

test <- labeled%>%filter(Class=="BOMBAY")
corrplot(cor(test %>% select(-Class)), method = 'ellipse', type = "lower")

testb <- labeled%>%filter(Class=="CALI")
corrplot(cor(testb %>% select(-Class)), method = 'ellipse', type = "lower")

test <- labeled%>%filter(Class=="DERMASON")
corrplot(cor(test %>% select(-Class)), method = 'ellipse', type = "lower")

test <- labeled%>%filter(Class=="SEKER")
corrplot(cor(test %>% select(-Class)), method = 'ellipse', type = "lower")

test <- labeled%>%filter(Class=="SIRA")
corrplot(cor(test %>% select(-Class)), method = 'ellipse', type = "lower")

test <- labeled%>%filter(Class=="HOROZ")
corrplot(cor(test %>% select(-Class)), method = 'ellipse', type = "lower")

```




